Rem ***** Included Source File *****

type laser_type
	x
	y
	sprite_id
	kill_me
endtype

function laser_spawn()
	s_id = array count(laser()) + 50
	i = array count(laser())
	laser(i).x = player.x + 10
	laser(i).y = player.y - 32
	laser(i).sprite_id = s_id
	laser(i).kill_me = 0
	set sprite s_id,0,1 rem sprite id 50 to 70
	sprite s_id, laser(i).x, laser(i).y, 4
	rem show sprite laser(i).sprite_id
	array insert at bottom laser()
endfunction

function delete_laser(i)
	rem hide sprite laser(i).sprite_id rem we hide the sprite first and later delete all hidden sprites from array
	rem delete sprite laser(i).sprite_id rem crashes the whole thing ... if the debugger would just be working
	array delete element laser(), i rem deletes stuff too early if spamming
endfunction

function laser_update()	
	if array count(laser()) > 0
		for t=0 to array count(laser())-1
			laser(t).y = laser(t).y - 10
			rem if sprite visible(laser(t).sprite_id) = 1 rem workaround for that sprite array stuff 
				rem if sprite exist(laser(t).sprite_id)
					 sprite laser(t).sprite_id, laser(t).x, laser(t).y, 4 rem enemy is sprite id 50 to 70			
				rem endif
			rem else
				rem delete sprite laser(t).sprite_id
				rem array delete element laser()						 
			rem endif
			if laser(t).y < -100 rem buggy as hell but I can't see why?
				laser(t).x = -10 rem we hide the sprites off screen until they get reused
				laser(t).kill_me = 1
				rem array delete element laser(), i rem deletes stuff too early if spamming
				rem delete_laser(t) rem fucntion call does not work as intended
			endif			
		next
	endif
endfunction